<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<!-- Generated Mar 1, 2016 5:26:24 PM by Hibernate Tools 4.3.1.Final -->
<hibernate-mapping>
	<query name="consultarProyectosUsuariosPorProyectoYUsuario">
	   	<![CDATA[
	   		Select proyUsuarios from VtProyectoUsuario proyUsuarios where proyUsuarios.vtProyecto.proyCodigo=:proyCodigo and proyUsuarios.vtUsuario.usuaCodigo=:usuaCodigo
	   	]]>
	</query>

	<query name="consultarArtefactosPorPilaProductoSinSprintAsignado">
	   	<![CDATA[
	   		Select vtArt from VtArtefacto vtArt where vtArt.vtPilaProducto.pilaCodigo=:pilaCodigo and vtArt.vtSprint.spriCodigo IS null
	   	]]>
	</query>
	<query name="consultarUsuarioRolPorUsuarioYRol">
	   	<![CDATA[
	   		Select usuaRol from VtUsuarioRol usuaRol where usuaRol.vtUsuario.usuaCodigo=:usuaCodigo and usuaRol.vtRol.rolCodigo=:rolCodigo
	   	]]>
	</query>
	<query name="consultarUsuarioArtefactoPorUsuarioInteresArtefacto">
	   	<![CDATA[
	   		Select usuArt from VtUsuarioArtefacto usuArt where usuArt.vtUsuario.usuaCodigo=:usuaCodigo and usuArt.vtInteres.inteCodigo=:inteCodigo and usuArt.vtArtefacto.arteCodigo=:arteCodigo
	   	]]>
	</query>
	
	<query name="consultarArtefactosPorSprintYEstado">
	   	<![CDATA[
	   		Select art from VtArtefacto art where art.vtSprint.spriCodigo=:spriCodigo and art.vtEstado.estaCodigo=:estaCodigo
	   	]]>
	</query>
	
	<query name="sumatoriaEsfuerzoEstimadoDeArtefactoPorSprint">
	   	<![CDATA[
	   		Select sum(art.esfuerzoEstimado) as esfuerzo from VtArtefacto art where art.vtSprint.spriCodigo=:spriCodigo and art.activo = 'S'
	   	]]>
	</query>
	
	<query name="sumatoriaArtefactoPorTiempoDedicadoEnUnaFechaYSprintEspecifico">
	   	<![CDATA[
	   		Select sum(proAr.tiempoDedicado) from VtProgresoArtefacto as proAr, 
	   		VtArtefacto as art where str(proAr.fechaCreacion) LIKE :fecha 
	   		and proAr.vtArtefacto.arteCodigo = art.arteCodigo and art.vtSprint.spriCodigo=:spriCodigo
	   		
	   	]]>
	</query>
	
	<query name="rolActivoMasBajoPorUsuario">
	   	<![CDATA[
	   		select min(usuR.vtRol.rolCodigo) from VtUsuarioRol as usuR where usuR.vtUsuario.usuaCodigo =:usuaCodigo and usuR.activo = 'S'
	   	]]>
	</query>
	
	<query name="ListaDesarrolladoresVortexYClientesDeOtraEmpresa">
	   	<![CDATA[
	   		select usuR from VtUsuario as usu,VtUsuarioRol as usuR where 
	   		(usu.vtEmpresa.emprCodigo = 1 and usuR.vtRol.rolCodigo = 2 and usu.usuaCodigo = usuR.vtUsuario.usuaCodigo and usu.activo = 'S' and usuR.activo = 'S') 
	   		or (usu.vtEmpresa.emprCodigo =:emprCodigo and usuR.vtRol.rolCodigo = 3 and usu.usuaCodigo = usuR.vtUsuario.usuaCodigo and usu.activo = 'S' and usuR.activo = 'S')
	   	]]>
	</query>
	

</hibernate-mapping>
